# 2.7 El Modelo de Caja

## Intro: La F칤sica de CSS

En CSS, no importa si ves un c칤rculo, un tri치ngulo o un texto. Para el motor de renderizado, **TODO es una caja rectangular**.
Comprender c칩mo se calcula el tama침o de esa caja es el 50% de CSS.

---

## Anatom칤a de la Caja (Box Model)
Cada elemento HTML es una caja rectangular compuesta por 4 capas (de adentro hacia afuera):
1.  **Content:** El contenido real (texto, imagen).
2.  **Padding:** Relleno interno transparente. (Separaci칩n entre el borde y el contenido).
3.  **Border:** El borde de la caja.
4.  **Margin:** Espacio externo transparente. (Separaci칩n entre esta caja y las dem치s).

---

## `box-sizing: border-box` (La Regla de Oro)
Por defecto, CSS suma el padding y el border al ancho que t칰 defines (`content-box`). Esto rompe los dise침os.
**Soluci칩n:** Usa siempre `box-sizing: border-box`.
Con esto, si dices `width: 200px`, la caja medir치 200px en total, incluyendo padding y borde.

Agrega esto siempre al inicio de tu CSS:
```css
* {
    box-sizing: border-box;
}
```

---

## Margin Collapse (El Colapso de M치rgenes)

CSS tiene una regla extra침a para "ayudar" a escribir texto, pero confunde en layouts.

**Regla:** Si dos elementos tienen m치rgenes verticales (top/bottom) adyacentes, sus m치rgenes **no se suman**. Se fusionan y gana el mayor.

### Ejemplo
```css
h1 { margin-bottom: 30px; }
p { margin-top: 20px; }
```
*   Esperado: 30 + 20 = 50px de espacio.
*   Realidad: **30px**. (El 30 se "c칩meme" al 20).

### Excepciones (C칩mo evitarlo)
Los m치rgenes NO colapsan si:
1.  Hay algo entre ellos (un borde o padding en el padre).
2.  Usas Flexbox o Grid.
3.  Usas `overflow: hidden`.

---

## Tipos de Visualizaci칩n (`display`)
*   **`block`:** Ocupa todo el ancho (ej. `div`, `p`, `h1`). Salta de l칤nea.
*   **`inline`:** Ocupa solo lo necesario (ej. `span`, `a`, `strong`). No acepta ancho/alto.
*   **`inline-block`:** Como `inline` pero acepta ancho/alto (ej. botones).
*   **`none`:** Desaparece el elemento (no ocupa espacio).

---

## Overflow: Cuando el contenido desborda

Si metes un texto gigante en una caja fija de 100x100px.

*   `visible` (Default): El texto se sale de la caja y mancha lo de afuera.
*   `hidden`: Corta el exceso (se pierde).
*   `scroll`: Pone barras de scroll siempre (aunque no se necesiten).
*   `auto`: Pone barras de scroll solo si se necesitan.

---

## Fondos y Bordes Avanzados

### Backgrounds
```css
background: red url('gato.jpg') no-repeat center center / cover;
```
*   `cover`: Escala la imagen para cubrir todo el div sin deformarse (recorta si es necesario).
*   `contain`: Escala para que se vea toda la imagen (deja huecos).

### Border Radius
```css
border-radius: 10px; /* Esquinas redondeadas */
border-radius: 50%; /* Crea un c칤rculo perfecto (si es cuadrado) */
```

### Box Shadow
```css
/* x-offset | y-offset | blur | spread | color */
box-shadow: 10px 5px 5px 0px rgba(0,0,0,0.5);
```
*   *Tip:* Usa sombras sutiles para dar profundidad (Material Design).

---

## El Contexto de Formato de Bloque (BFC)

Concepto oscuro pero vital. Es una "regi칩n aislada" donde las reglas de layout cambian.

### 쯇ara qu칠 sirve?
1.  **Evitar el Margin Collapse:** Los m치rgenes de elementos dentro de un BFC no se fusionan con los de fuera.
2.  **Contener Floats:** Si un hijo tiene `float: left`, el padre colapsa su altura a 0. Crear un BFC en el padre lo obliga a crecer y envolver al hijo.

### C칩mo crear un BFC
*   `overflow: hidden` (El hack cl치sico).
*   `display: flow-root` (La forma moderna y correcta).
*   `display: flex` / `grid`.
*   `position: absolute`.

---

## Posicionamiento: Sacando la caja del flujo

La propiedad `position` cambia las reglas de gravedad.

### `static` (Default)
Sigue el flujo normal. Ignora `top`, `left`, `z-index`.

### `relative`
*   Sigue ocupando su espacio original en el flujo (no deja hueco).
*   Se desplaza *visualemente* respecto a s칤 mismo.
*   **Superpoder:** Crea un "punto de referencia" para sus hijos absolutos.

### `absolute`
*   Sale del flujo (deja de ocupar espacio, los dem치s elementos ocupan su lugar).
*   Se posiciona respecto a su **ancestro posicionado m치s cercano** (uno que no sea static).
*   Si no hay ancestros, se pega al `<body>`.

### `fixed`
*   Como `absolute`, pero relativo a la **VENTANA del navegador (Viewport)**.
*   No se mueve al hacer scroll. (Ej. Navbar pegajosa, Chat Widget).

### `sticky`
*   H칤brido. Es `relative` hasta que haces scroll y llegas a un punto, entonces se vuelve `fixed`.
*   *Requisito:* Necesita una coordenada (`top: 0`) y un padre con altura definida.

---

## Z-Index y el "Stacking Context"

Si pones `z-index: 9999` y no funciona, es porque no entiendes el Stacking Context.

**Regla:** El `z-index` solo funciona en elementos con `position` (todos menos static) o hijos de Flex/Grid.
**Jerarqu칤a:**
1.  Un hijo nunca puede estar (z-index) "detr치s" del fondo de su padre si el padre cre칩 un contexto de apilamiento.
2.  Si el Padre A tiene `z-index: 1` y el Padre B tiene `z-index: 2` -> TODOS los hijos de B estar치n por encima de los hijos de A, aunque los hijos de A tengan `z-index: 999999`.

---

## Layouts Modernos: Flexbox y Grid
Olv칤date de `float`. Hoy usamos tecnolog칤as modernas.

### Flexbox (1 Dimensi칩n)
Ideal para alinear elementos en una fila o columna (ej. men칰s, barras de herramientas).
```css
.contenedor {
    display: flex;
    justify-content: center; /* Centra horizontalmente */
    align-items: center; /* Centra verticalmente */
}
```

### Grid (2 Dimensiones)
Ideal para la estructura general de la p치gina (Header, Sidebar, Main, Footer).
```css
.grilla {
    display: grid;
    grid-template-columns: 200px 1fr; /* Columna fija y el resto flexible */
}
```

---

## Laboratorio de C칩digo: El Centrado Perfecto

Pregunta de entrevista de Google: "쮺칩mo centras un div vertical y horizontalmente?"

**M칠todo 1: Flexbox (El Est치ndar)**
```css
.padre {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}
```

**M칠todo 2: Grid (El Hacker)**
```css
.padre {
    display: grid;
    place-items: center;
    height: 100vh;
}
```

**M칠todo 3: Position Absolute (El Old School)**
```css
.hijo {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
}
```

**M칠todo 4: Auto Margin (Giga Chad)**
Solo funciona en Flex/Grid containers.
```css
.padre { display: flex; height: 100vh; }
.hijo { margin: auto; }
```

---

## Glosario y Referencias

*   **Axis:** Eje. Flexbox tiene Main Axis y Cross Axis.
*   **Collapsing Margins:** El comportamiento de fusi칩n de m치rgenes verticales.
*   **Flow:** El flujo normal de lectura (de arriba a abajo, de izquierda a derecha).
*   **Viewport:** El 치rea visible de la p치gina.
*   **Reference:** [CSS-Tricks: A Complete Guide to Flexbox](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

---

## Propiedades L칩gicas: El fin de `left` y `right`

En la web internacional, "Izquierda" no siempre es el inicio. En 츼rabe, el inicio es la derecha.
CSS invent칩 propiedades l칩gicas que se adaptan autom치ticamente.

### Mapeo Mental
*   `width` -> `inline-size` (Tama침o en el texto fluye).
*   `height` -> `block-size` (Tama침o en el bloque apilado).
*   `margin-top` -> `margin-block-start`.
*   `margin-bottom` -> `margin-block-end`.
*   `margin-left` -> `margin-inline-start` (Si es ingl칠s es Left, si es 치rabe es Right).
*   `margin-right` -> `margin-inline-end`.

**Consejo 2025:** Deja de usar `margin-left`. Usa `margin-inline-start`. Tu yo del futuro te lo agradecer치 cuando tengas que traducir la web.

---

## Aspect Ratio y Multimedia

Antes para hacer un video responsive de 16:9 necesitabas un "padding hack" horrible.
Ahora:
```css
.video-container {
    width: 100%;
    aspect-ratio: 16 / 9;
    background: black;
}
```
Si el ancho cambia, la altura se calcula sola. Magia pura.

---

## Container Queries (`@container`) - El Futuro

Las Media Queries (`@media (max-width: 600px)`) tienen un fallo fatal: miran la pantalla entera.
Pero un componente (ej. una tarjeta de producto) puede estar en una sidebar estrecha o en el contenido principal ancho.
La tarjeta deber칤a reaccionar a **su contenedor**, no a la pantalla.

### Sintaxis
1.  **Definir el contenedor:**
    ```css
    .sidebar {
        container-type: inline-size; /* Vigila mi ancho */
        container-name: sidebar;     /* Opcional */
    }
    ```

2.  **Usar la query:**
    ```css
    @container (min-width: 400px) {
        /* Si el contenedor de la tarjeta mide m치s de 400px... */
        .card {
            display: flex; /* ...pon la imagen al lado del texto */
        }
    }
    ```

**Impacto:** Esto permite crear componentes verdaderamente "agn칩sticos" que funcionan bien donde sea que los tires.

---

## Funciones Matem치ticas (`calc`, `clamp`)

CSS tiene calculadora integrada.

### `calc()`
Mezcla unidades.
```css
/* El ancho total menos 50px de margen */
width: calc(100% - 50px); 
```

### `clamp(min, val, max)`
La funci칩n definitiva para tipograf칤a fluida.
```css
/* 
   - Nunca menos de 1rem.
   - Idealmente 5% del ancho de pantalla (5vw).
   - Nunca m치s de 2rem.
*/
font-size: clamp(1rem, 5vw, 2rem);
```
Adi칩s a escribir 50 media queries para tama침os de fuente.

---

---

## Grid Layout a Fondo: Pintando con ASCII

`grid-template-areas` es la caracter칤stica m치s subestimada de CSS. Te permite visualizar tu layout en el c칩digo.

### Ejemplo Complejo
```css
.layout {
    display: grid;
    grid-template-columns: 200px 1fr 200px;
    grid-template-rows: auto 1fr auto;
    gap: 20px;
    grid-template-areas:
        "header header header"
        "sidebar content ads"
        "footer footer footer";
}

.header { grid-area: header; }
.sidebar { grid-area: sidebar; }
.content { grid-area: content; }
.ads { grid-area: ads; }
.footer { grid-area: footer; }
```
*   **Media Query:** Para hacer esto responsive, solo redefines las 치reas en el media query.
    ```css
    @media (max-width: 600px) {
        .layout {
            grid-template-columns: 1fr;
            grid-template-areas:
                "header"
                "content"
                "sidebar"
                "ads"
                "footer";
        }
    }
    ```
    춰Sin tocar m치rgenes ni floats! Solo reordenas las strings.

---

## Subgrid (Grid 2.0)

El problema de Grid nivel 1 es que los nietos no pueden alinearse con la grilla del abuelo.
`subgrid` soluciona esto.

### El Problema
Tienes una tarjeta dentro de una grilla. La tarjeta tiene t칤tulo, texto y pie.
Quieres que el pie de TODAS las tarjetas est칠 alineado, aunque unas tengan m치s texto que otras.

### La Soluci칩n
```css
.grid-padre {
    display: grid;
    grid-template-rows: auto 1fr auto; /* T칤tulo, Contenido, Pie */
}

.tarjeta {
    grid-row: span 3; /* Ocupa 3 filas del padre */
    display: grid;
    grid-template-rows: subgrid; /* Hereda las filas del abuelo */
}
```
Ahora el contenido de la tarjeta dicta el tama침o de la fila de LA GRILLA EXTERNA. Alineaci칩n perfecta m치gica.

---

## Frameworks de Layout: 쯉iguen siendo necesarios?

Hace 10 a침os, necesit치bamos Bootstrap Grid System (`.col-md-4`) porque no exist칤a Grid nativo.

| M칠todo | HTML | CSS | Flexibilidad |
| :--- | :--- | :--- | :--- |
| **Bootstrap Grid** | Sucio (`<div class="row"><div class="col-4">`) | Pesado (Librer칤a externa) | Limitada a 12 columnas. |
| **Grid Nativo** | Limpio (`<div class="gallery">`) | Ligero (`display: grid`) | Infinita (N columnas). |

**Veredicto 2025:**
No uses el sistema de Grid de Bootstrap A MENOS que sea un proyecto legacy.
Abrende CSS Grid nativo. Es m치s potente, m치s limpio y est치ndar.

---

---

## Funciones CSS Nivel Dios

Deja de usar p칤xeles fijos. Usa matem치tica.

### `min()` y `max()`
*   `width: min(500px, 100%)`: Elige el valor MENOR.
    *   Si la pantalla es gigante, usa 500px.
    *   Si es un m칩vil de 300px, usa 100% (300px).
    *   **Resultado:** Responsive autom치tico sin media queries.

### `minmax(min, max)`
Exclusivo de Grid.
```css
grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
```
*   "Crea tantas columnas como quepan. Cada una debe medir AL MENOS 250px, pero si sobra espacio, est칤rate (`1fr`)".
*   Este es el **Pattern RAM (Repeat, Auto, Minmax)**. El layout m치s 칰til de la historia.

### `fit-content(value)`
"Crece seg칰n tu contenido, pero no te pases de X p칤xeles".

---

## Proyecto Final: Layout "Intrinsic" (Sin Media Queries)

El santo grial del dise침o web moderno es no usar `@media`.

```css
.holy-grail {
    display: grid;
    height: 100vh;
    /* 
       Sidebar: 250px fija
       Content: El resto
    */
    grid-template-columns: 250px 1fr;
    grid-template-rows: auto 1fr auto;
    gap: var(--gap);
}

/* Responsividad M치gica */
/* Si el ancho es menor a 600px, la sidebar desaparece o se mueve */
.sidebar {
    display: none; /* Simplificado para el ejemplo */
}

/* El verdadero truco intrinsic para galer칤as */
.gallery {
    display: grid;
    /* Esto crea columnas responsive autom치ticas */
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1rem;
}
```

### El Futuro: Masonry
Grid nivel 3 traer치 soporte nativo para Masonry (tipo Pinterest).
```css
.pinterest {
    display: grid;
    grid-template-rows: masonry; /* A칰n experimental en 2025 */
}
```

---

## Glosario de Layout Avanzado

*   **Fraction (`fr`):** Unidad de distribuci칩n de espacio libre. NO es porcentaje.
*   **Implicit Grid:** Filas/Columnas que el navegador crea autom치ticamente cuando metes m치s contenido del que definiste.
*   **Gutters:** El espacio entre celdas (`gap`).
*   **Intrinsic Sizing:** Dejar que el contenido defina el tama침o (`max-content`).
*   **Extrinsic Sizing:** Forzar un tama침o fijo (`width: 500px`).

---

---

## Debugging de Layouts: Herramientas

No adivines. Inspecciona.

### Inspector de Grid y Flex
En Chrome/Firefox DevTools, al lado de `<div display="grid">` aparece una etiqueta `grid`.
*   **Clickeala:** Dibuja las l칤neas de la grilla en la pantalla.
*   **Clickea `flex`:** Muestra el espacio libre y c칩mo se distribuyen los items.

### "Computed" Tab
A veces escribes `width: 50%` pero no sabes cu치nto es.
Ve a la pesta침a **Computed**. Te dir치: `width: 384.5px`.
Ah칤 tambi칠n ver치s si alguna otra regla est치 sobreescribiendo tu estilo (tachado).

---

## Errores Cl치sicos de Novato

### "El `z-index` no funciona"
*   **Causa:** El elemento es `position: static` (por defecto).
*   **Soluci칩n:** Ponle `position: relative`.

### "El margen no empuja"
*   **Causa:** Margin Collapse o el elemento es `display: inline` (`<span>`).
*   **Soluci칩n:** Hazlo `display: block` o `inline-block`.

### "Aparece un scroll horizontal fantasma"
*   **Causa:** Alg칰n elemento mide `100vw` pero ignoraste la barra de scroll vertical (que ocupa ~15px). O usaste `width: 100% + padding` sin `border-box`.
*   **Soluci칩n:** `outline: 1px solid red` a todo (`*`) para encontrar al culpable que se sale del layout.

---

---

## Layout Multi-Columna (Tipo Peri칩dico)

Un m칩dulo olvidado de CSS que es incre칤ble para texto largo.
No es Flexbox, no es Grid. Son columnas de texto reales.

```css
.article {
    column-count: 3; /* Divide el texto en 3 columnas */
    column-gap: 2rem; /* Espacio entre ellas */
    column-rule: 1px solid gray; /* L칤nea divisoria */
}

h2 {
    column-span: all; /* El t칤tulo rompe las columnas y ocupa todo el ancho */
}
```
*   **Magia:** El texto fluye de la columna 1 a la 2 autom치ticamente.

---

## `display: contents` (El Fantasma)

A veces tienes un `div` que solo estorba para el Grid/Flexbox, pero lo necesitas para sem치ntica o React.

```html
<div class="grid">
    <div class="wrapper"> <!-- Este div rompe el grid -->
        <div class="item">Item</div>
    </div>
</div>
```

**Soluci칩n:**
```css
.wrapper {
    display: contents;
}
```
*   **Efecto:** El navegador "borra" la caja del `.wrapper` visualmente.
*   Sus hijos (`.item`) se comportan como s fueran hijos directos de `.grid`.
*   El `.wrapper` sigue existiendo en el DOM, pero no genera `box` ni padding ni margin.

---

<div align="center">

[拘勇 Anterior: 2.6 Selectores](2.6.md) &nbsp;&nbsp;|&nbsp;&nbsp; [游 Volver al 칈ndice](../../README.md)

</div>
