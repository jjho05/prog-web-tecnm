# 2.6 Selectores

## Introducci√≥n

El selector es el francotirador de CSS.
Si apuntas mal, le das al elemento equivocado o no le das a nada.
Dominar los selectores es dominar la cascada.

---

### Lo esencial
*   **Etiqueta (`p`):** Afecta a todos los p√°rrafos. (Poco espec√≠fico).
*   **Clase (`.boton`):** Afecta a elementos con `class="boton"`. (Lo que m√°s usar√°s).
*   **ID (`#header`):** Afecta a un elemento √∫nico `id="header"`. (Muy espec√≠fico, evita usarlo para estilos).
*   **Universal (`*`):** Afecta a TODO. √ösalo con cuidado (principalmente para resets).

> **üíª C√≥digo en Acci√≥n:**
> Juega con los selectores en este laboratorio interactivo.
>
> üìÑ **Ver c√≥digo:** [04_selectores_css.html](codigos/04_selectores_css.html)

---

### Relaciones (Combinadores)
*   **Descendiente (`div p`):** Todos los p√°rrafos dentro de un div.
*   **Hijo Directo (`div > p`):** Solo los hijos directos (no nietos).
*   **Hermano Adyacente (`h1 + p`):** El elemento que est√° *inmediatamente* despu√©s.
*   **Hermano General (`h1 ~ p`):** Cualquier hermano que venga despu√©s.

---

## Selectores de Atributo: El Poder Oculto

Puedes seleccionar elementos por sus atributos HTML. Es brutal para inputs y links.

### Existencia y Valor Exacto
*   `[disabled]`: Elementos que tengan el atributo disabled.
*   `[type="text"]`: Inputs de texto.

### Coincidencias de Cadena (Regex-like)
*   **Empieza con (`^=`):**
    ```css
    a[href^="https"] { color: green; } /* Sitios seguros */
    ```
*   **Termina con (`$=`):**
    ```css
    a[href$=".pdf"]::after { content: " (PDF)"; } /* Icono de PDF */
    ```
*   **Contiene (`*=`):**
    ```css
    img[src*="logo"] { width: 100px; }
    ```

---

## Pseudo-clases Estructurales

### Estados (Pseudo-clases)
Empiezan con `:`. Definen un estado especial.
*   `:hover`: Cuando pasas el mouse por encima.
*   `:focus`: Cuando el elemento est√° seleccionado (ej. al escribir en un input).
*   `:first-child`: El primer hijo de su padre.
*   `:last-child`: El √∫ltimo hijo.
*   `:nth-child(even/odd)`: Pares o impares (√∫til para tablas).
*   `:not(.clase)`: Todo lo que NO tenga esa clase.

---

### Elementos Virtuales (Pseudo-elementos)
Empiezan con `::`. Crean contenido falso.
*   `::before` y `::after`: Inserta contenido est√©tico antes o despu√©s. Requiere `content: ''`.
*   `::placeholder`: Estila el texto de ayuda de un input.

---

### Especificidad (¬øQui√©n gana?)
El navegador usa un sistema de puntos para decidir qu√© estilo aplicar si hay conflictos.
1.  **`!important`** (Gana a todo, √∫salo poco).
2.  **Estilo en l√≠nea (`style="..."`)** (Gana a ID).
3.  **ID (`#id`)** (Gana a Clases).
4.  **Clase (`.class`)** (Gana a Etiquetas).
5.  **Etiqueta (`div`)** (El m√°s d√©bil).

**Regla:** Intenta usar siempre Clases. Evita IDs y `!important` para estilos CSS.

---

### Selectores Modernos (`:is`, `:where`, `:has`)
*   `:is(h1, h2, h3)`: Agrupa selectores.
*   `:where(h1, h2, h3)`: Igual que `:is` pero con especificidad 0 (f√°cil de sobreescribir).
*   `:has(img)`: "Selecciona el padre, si tiene una imagen dentro". (El selector padre por fin existe).

---

## Performance: El Mito de "Derecha a Izquierda"

Los navegadores leen los selectores de **Derecha a Izquierda**.
Selector: `div > .btn`
1.  Navegador: "Busca todos los elementos con clase `.btn`". (Hay 50).
2.  Navegador: "De esos 50, mira si su padre directo es un `div`". (Filtrado).

Por esto:
*   `.container *`: **LENTO.** Primero busca TODOS los elementos del DOM (*), y luego verifica si est√°n dentro de container.
*   `.btn`: **R√ÅPIDO.** Solo busca la clase.

*En 2025, las computadoras son tan r√°pidas que esto casi no importa, a menos que tengas 50,000 elementos en el DOM.*

---

## Pseudo-clases Estructurales Avanzadas

### `:nth-of-type`
A diferencia de `nth-child`, este solo cuenta elementos del mismo tipo.
```html
<div>
    <h1>Hola</h1> <!-- child 1 -->
    <p>Texto</p>  <!-- child 2, p:nth-of-type(1) -->
    <p>Texto</p>  <!-- child 3, p:nth-of-type(2) -->
</div>
```
*   `p:nth-child(1)`: NO selecciona nada (el hijo 1 es h1).
*   `p:nth-of-type(1)`: Selecciona el primer p√°rrafo.

### `:empty`
Selecciona elementos vac√≠os.
```css
div:empty { display: none; }
```
*   *Ojo:* Un espacio en blanco cuenta como contenido (en algunos navegadores viejos).

---

## Laboratorio de C√≥digo: "El Selector Imposible"

Intenta resolver estos retos mentales.

**Reto 1: El Tablero de Ajedrez**
Pinta un tablero de 8x8 usando `div`s y `:nth-child`.
*   *Pista:* `nth-child(even)` no basta, porque en la siguiente fila los colores se invierten.
*   *Soluci√≥n:* Matem√°ticas modulares o `:nth-child` con f√≥rmulas complejas `an+b`.

**Reto 2: Estilos Condicionales sin clases**
Tienes una lista `<ul>`.
*   Si tiene menos de 3 items, p√≠ntalos rojos.
*   Si tiene m√°s de 10, p√≠ntalos azules.
*   *Pista:* `li:first-child:nth-last-child(n+10) ~ li`. (Quantity Queries).

---

## Referencias y Glosario

*   **Specificity Calculator:** Herramienta online para pelear con `!important`.
*   **Combinator:** S√≠mbolo que une dos selectores (`+`, `>`, `~`).
*   **Pseudo-class:** Estado (`:hover`).
*   **Pseudo-element:** Parte l√≥gica (`::before`).

---

## El Axioma del B√∫ho Lobotomizado (`* + *`)

Inventado por Heydon Pickering.
```css
* + * {
    margin-top: 1.5em;
}
```
*   **¬øQu√© hace?** Selecciona cualquier elemento que tenga un hermano antes. (O sea, **todos menos el primero**).
*   **¬øPor qu√© es genio?**
    *   Le da margen superior a todos los p√°rrafos, pero NO al primero del contenedor.
    *   No necesitas `:last-child { margin-bottom: 0 }`.
    *   Mantienes el ritmo vertical perfecto autom√°ticamente.

---

## Recetario de `nth-child` (Copia y Pega)

Dominar `an + b` te hace un mago.

| F√≥rmula | Selecci√≥n | Explicaci√≥n |
| :--- | :--- | :--- |
| `:nth-child(3)` | El 3 | Solo el tercer hijo. |
| `:nth-child(n+4)` | Del 4 en adelante | Selecciona 4, 5, 6... (Ignora los primeros 3). |
| `:nth-child(-n+3)` | Los primeros 3 | Selecciona 1, 2, 3. (Matem√°tica: -0+3=3, -1+3=2, -2+3=1). |
| `:nth-child(3n)` | M√∫ltiplos de 3 | 3, 6, 9, 12... |
| `:nth-child(odd)` | Impares | 1, 3, 5... (Zebra Striping). |
| `:nth-child(even)` | Pares | 2, 4, 6... |
| `:nth-last-child(1)` | El √∫ltimo | Igual a `:last-child`. |
| `:nth-last-child(2)` | El pen√∫ltimo | Cuenta desde el final. |

### Quantity Queries
"Estila esto SOLO si hay 5 elementos o menos".
```css
/* Si hay 5 o menos hijos, p√≠ntalos a todos de verde */
li:first-child:nth-last-child(-n+5),
li:first-child:nth-last-child(-n+5) ~ li {
    color: green;
}
```

---

## Selectores de Interacci√≥n Avanzada

M√°s all√° de `:hover`.

### `:focus-within` (El Salvador de los Dropdowns)
Selecciona un elemento si **√©l o alguno de sus hijos** tiene el foco.
*   *Caso de uso:* Un formulario que brilla entero cuando escribes en un input.
    ```css
    form:focus-within {
        box-shadow: 0 0 10px blue;
    }
    ```
*   *Caso de uso 2:* Dropdowns accesibles sin JS.

### `:target` (Modales sin JS)
Selecciona el elemento cuyo ID coincide con la URL (`#modal1`).
```css
.modal { display: none; }
.modal:target { display: block; }
```
URL: `misitio.com/#modal1` -> El modal se abre.

### `:indeterminate`
Para checkboxes que no est√°n ni checked ni unchecked (estado "hijo parcial").
```css
input:indeterminate {
    background-color: gray;
}
```
Solo activable v√≠a JS (`checkbox.indeterminate = true`).

---

---

## Selectores de Internacionalizaci√≥n

La web es mundial. CSS te ayuda.

### `:lang()`
Estilos espec√≠ficos por idioma.
```css
/* Las comillas en franc√©s son diferentes */
:lang(fr) q { quotes: '¬´' '¬ª'; }
```

### `:dir()` (Directionality)
Para idiomas de derecha a izquierda (RTL) como √Årabe o Hebreo.
```css
/* Si el texto va de derecha a izquierda, el margen va a la izquierda */
:dir(rtl) .icon { margin-left: 10px; margin-right: 0; }
```
*   *Nota:* Es mejor usar Propiedades L√≥gicas (`margin-inline-start`) hoy en d√≠a.

---

## Selectores de Validaci√≥n y UX (Nivel Experto)

Mejora la experiencia del usuario sin JS.

### `:placeholder-shown` (El detector de campo vac√≠o)
Detecta si el usuario ha escrito algo o no.
```css
/* Si se muestra el placeholder, es que est√° vac√≠o */
input:placeholder-shown { border-color: gray; }
input:not(:placeholder-shown) { border-color: blue; }
```

### `:focus-visible` (El anillo de la accesibilidad)
El navegador pone un anillo azul feo (`outline`) al hacer clic.
Muchos devs lo quitan (`outline: none`). **ERROR GRAVE.**
Los usuarios de teclado lo necesitan.
*   **Soluci√≥n:**
    ```css
    /* Solo mu√©stralo si usa teclado o es necesario */
    button:focus-visible {
        outline: 3px solid hotpink;
        outline-offset: 2px;
    }
    button:focus:not(:focus-visible) {
        outline: none; /* Mouse users don't see it */
    }
    ```

### `:user-invalid` (El futuro)
`:invalid` marca el error *inmediatamente* (molesto).
`:user-invalid` marca el error solo *despu√©s* de que el usuario interactu√≥. (Soporte limitado a√∫n, pero llegar√°).

---

## Hackeando la Especificidad

A veces necesitas ganar, a veces necesitas perder.

### `:where()` (La nulificadora)
Reduce la especificidad a CERO (0-0-0).
```css
/* .btn tiene especificidad 0-1-0 */
:where(.btn) { color: red; } 

/* .card tiene especificidad 0-1-0 y GANA, aunque est√© arriba */
.card { color: blue; }
```
*   *Uso:* Ideal para CSS Resets o Librer√≠as base.

### `@layer` (Capas de Cascada)
Olv√≠date de calcular n√∫meros. Organiza por capas.
```css
@layer base, components, utility;

@layer base {
    h1 { color: red !important; } /* Gana dentro de su capa, pero... */
}

@layer utility {
    h1 { color: blue; } /* ...las capas posteriores ganan SIEMPRE. */
}
```
*   **Resultado:** Azul. `@layer utility` gana a `@layer base` sin importar la especificidad interna.

---

## Performance y el Render Tree

¬øImporta qu√© selector uso?

### El Mito del Selector Universal
`* { box-sizing: border-box; }`
Antiguamente dec√≠an que era lento.
Hoy (2025): **Despreciable.** √ösalo con confianza.

### Descendientes Profundos
`.header .nav ul li a span`
*   El navegador lee de derecha a izquierda: "Busca todos los span... y mira si est√°n dentro de un a... dentro de un li...".
*   **Problema:** Costoso si el DOM cambia mucho.
*   **Soluci√≥n:** Usa clases directas: `.nav-text`. (BEM te obliga a esto por dise√±o).

### Selectores de Atributo caros
`[href*="cadena"]` (Substring matching).
Es m√°s lento que una clase id√©ntica (`.link-pdf`), pero solo importa si tienes miles de ellos.

---

---

## Los Anti-Patrones: Lo que NUNCA debes hacer

### ID para Estilos
```css
/* MAL */
#header { background: black; }
```
*   **Por qu√©:** Su especificidad es demasiado alta (1-0-0). Si quieres cambiar el color en una landing page espec√≠fica, tendr√°s que usar `!important` o repetir el ID.
*   **Alternativa:** Usa clases (`.header`). Deja los IDs para JS y anclas.

### Selectores "Trenzados"
```css
/* MAL */
div.container > ul.menu li a.link span { ... }
```
*   **Por qu√©:** Esto "ata" tus estilos a la estructura HTML exacta. Si cambias el `span` por un `i`, se rompe.
*   **Alternativa:** `.menu-icon { ... }`.

### `!important` perezoso
```css
.btn { color: red !important; }
```
*   **Por qu√©:** Ahora no hay forma de tener un bot√≥n azul sin usar otro `!important`. Es una carrera armamentista nuclear.

---

## Selectores L√≥gicos y de Medios (Multimedia)

CSS4 trae selectores para video y audio.

### Estados de Reproducci√≥n
```css
video:playing {
    border: 5px solid green;
}

video:paused {
    filter: grayscale(100%);
}
```
*   *Uso:* UI reactiva sin JS.

### Pantalla Completa
```css
:fullscreen {
    background: black;
    color: white;
}
```

---

## Proyecto Final: El Juego de los Selectores

Imagina una mesa (`div.table`) con platos (`plate`) y comida.
Escribe el selector para:

**Nivel 1:** Selecciona los platos vac√≠os.
*   *HTML:* `<plate></plate> <plate><apple /></plate>`
*   *Soluci√≥n:* `plate:empty`

**Nivel 2:** Selecciona el pepino (`pickle`) en el plato peque√±o.
*   *HTML:* `<plate id="fancy"><pickle /></plate> <plate><pickle /></plate>`
*   *Soluci√≥n:* `#fancy pickle` (O mejor `.fancy pickle`).

**Nivel 3:** Selecciona el 3er plato solo si tiene una naranja.
*   *Soluci√≥n:* `plate:nth-child(3):has(orange)` (Nivel Dios).

---

## Glosario de Selectores

*   **Combinator:** S√≠mbolo que define la relaci√≥n (`>`, `+`, `~`, ` `).
*   **Descendant:** Cualquier elemento anidado, sin importar el nivel.
*   **Pseudo-class:** Estado o caracter√≠stica (`:hover`, `:empty`). Empieza con `:`.
*   **Pseudo-element:** Parte virtual del DOM (`::before`, `::placeholder`). Empieza con `::`.
*   **Specificity:** Peso matem√°tico de un selector (ID > Clase > Tag).
*   **Wildcard:** El asterisco (`*`).

---

---

## Ejercicio Mental: ¬øDe qu√© color es el `h1`?

Resuelve esto sin mirar la respuesta.

```css
/* A */
#header h1 { color: red; } 

/* B */
html body header h1 { color: blue; }

/* C */
.title { color: green !important; }

/* D */
h1 { color: purple !important; }
```

**An√°lisis:**
*   A: 1-0-1 (ID + Tag).
*   B: 0-0-4 (4 Tags). (Muy baja).
*   C: 0-1-0 + `!important`.
*   D: 0-0-1 + `!important`.

**Respuesta:** **Verde (C).**
Aunque D tiene `!important`, C tiene mayor especificidad (Clase vs Etiqueta) Y `!important`.
A y B pierden contra los `!important`.

<div align="center">

[‚¨ÖÔ∏è Anterior: 2.5 Lenguajes de Presentaci√≥n](2.5.md) &nbsp;&nbsp;|&nbsp;&nbsp; [Siguiente: 2.7 Modelo de Caja](2.7.md) ‚û°Ô∏è

</div>
